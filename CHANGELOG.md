# 更新日志 (CHANGELOG)

所有重要的项目变更都会记录在此文件中。

格式基于 [Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/)，
版本号遵循 [语义化版本](https://semver.org/lang/zh-CN/)。

## [Unreleased]

### 计划中
- 更多眼睛主题
- 语音识别优化

---

## [v0.4.1] - 2026-01-09

### 新增 (Added)
- **服务器提醒同步功能**：实现与服务器的提醒双向同步 (SyncPull/SyncPush)
- **MCP 提醒工具**：通过 MCP 协议暴露提醒的增删改功能给 AI 助手
- **SNTP 时间同步**：集成 NTP 时间服务，支持 UTC+8 北京时区
- **提醒预唤醒机制**：到期前 15 秒自动建立网络连接
- **本地优先提醒**：时间到了立即弹窗并响铃，不依赖网络状态
- **定期同步**：每分钟自动与服务器同步提醒列表

### 优化 (Improved)
- 提醒内容智能清洗，移除"提醒轩轩爸爸"、"提醒我"等冗余词汇
- 匀速上传 TTS 音频，防止服务端识别异常
- 修复提醒语音上传后无法播放的问题
- 添加 SendStopListening 触发服务端立即响应
- 提醒 TTS 文案优化：使用【小助手提醒】标识，避免被识别为用户命令

### 技术细节
- 集成 ReminderManager 单例管理提醒生命周期
- 在 OnClockTimer 中处理到期提醒逻辑
- 支持相对时间 (delay_in_seconds) 和绝对时间提醒
- 音频帧字节对齐，确保完整 60ms 帧上传

---

## [v0.4.0] - 2026-01-08

### 新增 (Added)
- **深度优化提醒系统**：从 14-handheld 项目同步核心提醒功能
- **提醒任务队列**：使用 FreeRTOS 队列管理提醒任务
- **Opus 编码器**：为提醒功能专用编码器

### 优化 (Improved)
- 提醒触发流程优化
- 内存管理优化

---

## [v0.3.1] - 2026-01-05

### 新增 (Added)
- **提醒功能实现**：本地提醒系统基础功能
- **音频编码优化**：Opus 编码性能优化
- **栈溢出修复**：修复任务栈溢出问题

### 修复 (Fixed)
- 解决提醒任务栈大小不足的问题
- 优化内存使用

---

## [v0.3.0] - 2026-01-05

### 新增 (Added)
- **多表情动画系统**：支持多种眼睛表情切换
- **音频优化**：音频处理流程优化
- **唤醒词检测**：支持多种唤醒词

### 优化 (Improved)
- 动画渲染性能提升
- 音频编解码效率优化

---

## [v0.2.3] - 2026-01-05

### 新增 (Added)
- **MP4 视频转动画**：支持 MP4 格式视频转换为动画
- **240x240 全屏显示**：优化全屏显示效果

### 优化 (Improved)
- 视频解码性能
- 内存占用优化

---

## [v0.2.1] - 2026-01-04

### 新增 (Added)
- **PNG 序列帧动画系统**：支持 PNG 格式序列帧动画
- 动画播放控制

### 优化 (Improved)
- 动画加载速度
- 帧率稳定性

---

## [v0.2.0] - 2025-12-29

### 新增 (Added)
- **多眼睛样式**：添加多种眼睛主题样式
- **语音切换**：支持通过语音命令切换眼睛样式
- **主题管理**：主题系统基础架构

### 优化 (Improved)
- 显示效果优化
- 用户交互体验提升

---

## 版本说明

### 版本号规则
- **主版本号 (Major)**：不兼容的 API 修改
- **次版本号 (Minor)**：向下兼容的功能性新增
- **修订号 (Patch)**：向下兼容的问题修正

### 变更类型
- **新增 (Added)**: 新增功能
- **变更 (Changed)**: 对现有功能的变更
- **弃用 (Deprecated)**: 即将移除的功能
- **移除 (Removed)**: 已移除的功能
- **修复 (Fixed)**: 问题修复
- **安全 (Security)**: 安全相关修复

---

## 项目信息

- **项目名称**: xiaozhi-esp32 (双目 AI 机器人)
- **基于**: xiaozhi-esp32 分支
- **硬件平台**: ESP32-S3
- **显示**: 双 GC9A01 LCD (240x240)
- **功能**: 语音交互、AI 对话、提醒系统、MCP 协议

### 相关链接
- [原项目地址](https://github.com/78/xiaozhi-esp32)
- [服务器地址](https://xiaozhi.me)
