# 0.71å¯¸å±å¹•æ”¹é€ æŒ‡å—

## ğŸ“‹ æ”¹é€ æ¦‚è¿°

æœ¬æ–‡æ¡£è®°å½•äº†å°†åŒç›®æœºå™¨äººé¡¹ç›®ä» **1.28å¯¸ 240x240 GC9A01 å±å¹•** æ”¹é€ ä¸º **0.71å¯¸ 160x160 GC9D01N å±å¹•** çš„å®Œæ•´è¿‡ç¨‹ã€‚

**é¡¹ç›®ä¿¡æ¯**ï¼š
- é¡¹ç›®ç‰ˆæœ¬ï¼šv1.8.9
- å¼€å‘æ¿ï¼šbcore-8311-eyecam
- åŸå±å¹•ï¼šGC9A01ï¼Œ240x240ï¼Œ1.28å¯¸åœ†å½¢
- æ–°å±å¹•ï¼šGC9D01Nï¼Œ160x160ï¼Œ0.71å¯¸åœ†å½¢

---

## ğŸ”§ ç¡¬ä»¶æ¥çº¿

### ä¸»æ¿æ¥å£ â†’ 0.71å¯¸å±å¹•å¼•è„šæ˜ å°„

```
ä¸»æ¿æ¥å£     â†’   0.71å¯¸å±å¹•    è¯´æ˜
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
GND          â†’   GND           åœ°çº¿
3V3          â†’   VDD           3.3Vç”µæº
SCLK         â†’   SCL           SPIæ—¶é’Ÿ
SDA (MOSI)   â†’   SDA           SPIæ•°æ®
DC           â†’   DC            æ•°æ®/å‘½ä»¤é€‰æ‹©
RST          â†’   RST           å¤ä½ä¿¡å·
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
GND          â†’   CS            ç‰‡é€‰(ä½ç”µå¹³æœ‰æ•ˆ) âœ…
GND          â†’   BL            èƒŒå…‰(ä½ç”µå¹³æœ‰æ•ˆ) âœ…
```

**âš ï¸ é‡è¦è¯´æ˜**ï¼š
- **CSæ¥GND**ï¼šç‰‡é€‰ä½ç”µå¹³æœ‰æ•ˆï¼Œå•è®¾å¤‡å¯æ°¸ä¹…æ¥åœ°
- **BLæ¥GND**ï¼šæ­¤å±å¹•ä¸º**ä½ç”µå¹³æœ‰æ•ˆ**èƒŒå…‰è®¾è®¡ï¼ˆBLæ¥GNDèƒŒå…‰äº®ï¼‰
- è¿™ä¸å¸¸è§çš„å±å¹•è®¾è®¡ä¸åŒï¼Œè¯·æ³¨æ„åŒºåˆ†

### åŒå±é…ç½®

**å·¦çœ¼ï¼ˆSPI2_HOSTï¼‰**ï¼š
- SCLK: GPIO 38
- MOSI: GPIO 39
- RST: GPIO 40
- DC: GPIO 0

**å³çœ¼ï¼ˆSPI3_HOSTï¼‰**ï¼š
- SCLK: GPIO 42
- MOSI: GPIO 2
- RST: GPIO 1
- DC: GPIO 41

---

## ğŸ’» è½¯ä»¶ä¿®æ”¹

### 1. å¤åˆ¶GC9D01Né©±åŠ¨æ–‡ä»¶

å°†ä»¥ä¸‹æ–‡ä»¶ä» `lilygo-t-circle-s3` ç›®å½•å¤åˆ¶åˆ° `bcore-8311-eyecam` ç›®å½•ï¼š

```bash
# ä»
main/boards/lilygo-t-circle-s3/esp_lcd_gc9d01n.h
main/boards/lilygo-t-circle-s3/esp_lcd_gc9d01n.c

# å¤åˆ¶åˆ°
main/boards/bcore-8311-eyecam/esp_lcd_gc9d01n.h
main/boards/bcore-8311-eyecam/esp_lcd_gc9d01n.c
```

### 2. ä¿®æ”¹åˆ†è¾¨ç‡é…ç½®

#### æ–‡ä»¶ï¼š`main/display/eye_display.h`

```c
// ä¿®æ”¹å‰
#define GC9A01_LCD_H_RES   (240)
#define GC9A01_LCD_V_RES   (240)

// ä¿®æ”¹å
#define GC9A01_LCD_H_RES   (160)
#define GC9A01_LCD_V_RES   (160)
```

#### æ–‡ä»¶ï¼š`main/boards/bcore-8311-eyecam/config.h`

```c
// åˆ†è¾¨ç‡
#define DISPLAY_WIDTH   160
#define DISPLAY_HEIGHT  160

/* LCD size */
#define GC9A01_LCD_H_RES   (160)
#define GC9A01_LCD_V_RES   (160)

#define GC9A01_LCD_DRAW_BUFF_HEIGHT (160)
```

### 3. ä¿®æ”¹é©±åŠ¨åŒ…å«æ–‡ä»¶

#### æ–‡ä»¶ï¼š`main/boards/bcore-8311-eyecam/bcore-8311-eyecam.cc`

```c
// ä¿®æ”¹å‰
#include "esp_lcd_gc9a01.h"

// ä¿®æ”¹å
#include "esp_lcd_gc9d01n.h"
```

### 4. ä¿®æ”¹å±å¹•åˆå§‹åŒ–å‡½æ•°

#### å³çœ¼åˆå§‹åŒ–ï¼ˆSPI3_HOSTï¼‰

**æ–‡ä»¶**ï¼š`bcore-8311-eyecam.cc` ç¬¬131-165è¡Œ

```c
void InitializeGc9d01nDisplayEye1() {
    ESP_LOGI(TAG, "Init GC9D01N display1");

    ESP_LOGI(TAG, "Install panel IO1");
    const esp_lcd_panel_io_spi_config_t io_config = {
        .cs_gpio_num = GC9A01_SPI1_LCD_GPIO_CS,
        .dc_gpio_num = GC9A01_SPI1_LCD_GPIO_DC,
        .spi_mode = 0,
        .pclk_hz = GC9A01_LCD_PIXEL_CLK_HZ,
        .trans_queue_depth = 10,
        .lcd_cmd_bits = GC9A01_LCD_CMD_BITS,
        .lcd_param_bits = GC9A01_LCD_PARAM_BITS,
    };
    esp_lcd_new_panel_io_spi((esp_lcd_spi_bus_handle_t)GC9A01_LCD_SPI1_NUM, &io_config, &lcd_io1);
    lcd_io_eye = lcd_io1;

    ESP_LOGD(TAG, "Install LCD1 driver");
    esp_lcd_panel_dev_config_t panel_config = {
        .reset_gpio_num = GC9A01_SPI1_LCD_GPIO_RST,
        .color_space = GC9A01_LCD_COLOR_SPACE,
        .bits_per_pixel = GC9A01_LCD_BITS_PER_PIXEL,
    };
    panel_config.rgb_endian = DISPLAY_RGB_ORDER;
    esp_lcd_new_panel_gc9d01n(lcd_io1, &panel_config, &lcd_panel1);
    lcd_panel_eye = lcd_panel1;

    esp_lcd_panel_reset(lcd_panel1);
    esp_lcd_panel_init(lcd_panel1);
    esp_lcd_panel_invert_color(lcd_panel1, false);
    esp_lcd_panel_disp_on_off(lcd_panel1, true);
}
```

#### å·¦çœ¼åˆå§‹åŒ–ï¼ˆSPI2_HOSTï¼‰

**æ–‡ä»¶**ï¼š`bcore-8311-eyecam.cc` ç¬¬181-212è¡Œ

```c
void InitializeGc9d01nDisplayEye2() {
    ESP_LOGI(TAG, "Init GC9D01N display2");

    ESP_LOGI(TAG, "Install panel IO2");
    const esp_lcd_panel_io_spi_config_t io_config = {
        .cs_gpio_num = GC9A01_SPI2_LCD_GPIO_CS,
        .dc_gpio_num = GC9A01_SPI2_LCD_GPIO_DC,
        .spi_mode = 0,
        .pclk_hz = GC9A01_LCD_PIXEL_CLK_HZ,
        .trans_queue_depth = 10,
        .lcd_cmd_bits = GC9A01_LCD_CMD_BITS,
        .lcd_param_bits = GC9A01_LCD_PARAM_BITS,
    };
    esp_lcd_new_panel_io_spi((esp_lcd_spi_bus_handle_t)GC9A01_LCD_SPI2_NUM, &io_config, &lcd_io2);
    lcd_io_eye2 = lcd_io2;

    ESP_LOGD(TAG, "Install LCD2 driver");
    esp_lcd_panel_dev_config_t panel_config = {
        .reset_gpio_num = GC9A01_SPI2_LCD_GPIO_RST,
        .color_space = GC9A01_LCD_COLOR_SPACE,
        .bits_per_pixel = GC9A01_LCD_BITS_PER_PIXEL
    };
    panel_config.rgb_endian = DISPLAY_RGB_ORDER;
    esp_lcd_new_panel_gc9d01n(lcd_io2, &panel_config, &lcd_panel2);
    lcd_panel_eye2 = lcd_panel2;

    esp_lcd_panel_reset(lcd_panel2);
    esp_lcd_panel_init(lcd_panel2);
    esp_lcd_panel_invert_color(lcd_panel2, false);
    esp_lcd_panel_disp_on_off(lcd_panel2, true);
}
```

#### æ›´æ–°åŒå±åˆå§‹åŒ–è°ƒç”¨

**æ–‡ä»¶**ï¼š`bcore-8311-eyecam.cc` ç¬¬216-224è¡Œ

```c
void InitializeDualScreenEye(){
    // åˆå§‹åŒ–ç¬¬ä¸€å—å±å¹•
    InitializeSpiEye1();
    InitializeSpiEye2();
    InitializeGc9d01nDisplayEye1();
    InitializeGc9d01nDisplayEye2();

    // åˆ›å»ºåŒå±æ˜¾ç¤ºå¯¹è±¡
    display_ = new DualScreenDisplay(...);
}
```

### 5. é¢œè‰²é…ç½®

#### æ–‡ä»¶ï¼š`main/boards/bcore-8311-eyecam/config.h`

```c
// RGBé¡ºåºï¼šGC9D01Nä½¿ç”¨RGBé¡ºåºï¼ˆé‡è¦ï¼ï¼‰
#define DISPLAY_RGB_ORDER  LCD_RGB_ELEMENT_ORDER_RGB
```

**å…³é”®å¯¹æ¯”**ï¼š
- GC9A01ï¼ˆ240x240ï¼‰ï¼š`LCD_RGB_ELEMENT_ORDER_BGR`
- GC9D01Nï¼ˆ160x160ï¼‰ï¼š`LCD_RGB_ELEMENT_ORDER_RGB` âš ï¸

### 6. é¢œè‰²åè½¬è®¾ç½®

**ä¸¤å—å±å¹•éƒ½ä½¿ç”¨**ï¼š
```c
esp_lcd_panel_invert_color(lcd_panel1, false);  // ä¸æ˜¯trueï¼
esp_lcd_panel_invert_color(lcd_panel2, false);  // ä¸æ˜¯trueï¼
```

**å‚è€ƒ**ï¼šLilyGo T-Circle S3ï¼ˆGC9D01Nï¼‰ä½¿ç”¨ `false`

---

## ğŸ¨ åŠ¨ç”»æ•°æ®ç”Ÿæˆ

### æ­¥éª¤1ï¼šä»MP4æå–å¹¶æ—‹è½¬PNG

```bash
# åˆ›å»ºframesç›®å½•
mkdir -p examples/frames

# æå–ã€ç¼©æ”¾å¹¶é¡ºæ—¶é’ˆæ—‹è½¬90åº¦
ffmpeg -i examples/001.mp4 \
  -vf "fps=8,scale=160:160,transpose=1" \
  -t 2 \
  examples/frames/eye_%05d.png
```

**å‚æ•°è¯´æ˜**ï¼š
- `fps=8`: æ¯ç§’8å¸§
- `scale=160:160`: ç¼©æ”¾åˆ°160x160
- `transpose=1`: é¡ºæ—¶é’ˆæ—‹è½¬90åº¦ï¼ˆ0=90Â° clockwise, 1=90Â° clockwise, 2=90Â° counter-clockwise, 3=90Â° counter-clockwiseï¼‰
- `-t 2`: æå–å‰2ç§’

**è¾“å‡º**ï¼š16å¸§PNGå›¾åƒï¼ˆ160x160ï¼Œå·²æ—‹è½¬ï¼‰

### æ­¥éª¤2ï¼šè½¬æ¢ä¸ºCæ•°ç»„

```bash
python tools/png_to_array_optimized.py examples/frames eye --width 160 --height 160 --fps 8
```

**è¾“å‡ºæ–‡ä»¶**ï¼š`main/display/animations/anim_eye.h`

**åŠ¨ç”»ä¿¡æ¯**ï¼š
```
åˆ†è¾¨ç‡: 160x160
å¸§æ•°: 16å¸§
å¸§ç‡: 8 FPS
æ¯å¸§å¤§å°: 51,200 å­—èŠ‚ (160Ã—160Ã—2)
æ€»å¤§å°: 819,200 å­—èŠ‚ (çº¦ 800 KB)
```

---

## ğŸ”§ å…³é”®ä¿®æ”¹å¯¹æ¯”

### é©±åŠ¨èŠ¯ç‰‡å¯¹æ¯”

| é¡¹ç›® | GC9A01 (1.28å¯¸) | GC9D01N (0.71å¯¸) |
|------|-----------------|------------------|
| åˆ†è¾¨ç‡ | 240x240 | 160x160 |
| RGBé¡ºåº | BGR | **RGB** âš ï¸ |
| é¢œè‰²åè½¬ | true | **false** âš ï¸ |
| é©±åŠ¨æ–‡ä»¶ | esp_lcd_gc9a01 | esp_lcd_gc9d01n |

### åˆ†è¾¨ç‡é…ç½®æ±‡æ€»

| æ–‡ä»¶ | å®å®šä¹‰ | å€¼ |
|------|--------|-----|
| `eye_display.h` | `GC9A01_LCD_H_RES` | 160 |
| `eye_display.h` | `GC9A01_LCD_V_RES` | 160 |
| `config.h` | `DISPLAY_WIDTH` | 160 |
| `config.h` | `DISPLAY_HEIGHT` | 160 |
| `config.h` | `GC9A01_LCD_H_RES` | 160 |
| `config.h` | `GC9A01_LCD_V_RES` | 160 |
| `config.h` | `GC9A01_LCD_DRAW_BUFF_HEIGHT` | 160 |

---

## ğŸ¯ ç¼–è¯‘å’Œçƒ§å½•

### æ¸…ç†æ„å»ºç¼“å­˜

```bash
idf.py fullclean
```

### ç¼–è¯‘é¡¹ç›®

```bash
idf.py build
```

### çƒ§å½•åˆ°è®¾å¤‡

```bash
idf.py flash monitor
```

---

## âœ… éªŒè¯è¦ç‚¹

çƒ§å½•æˆåŠŸåï¼Œæ£€æŸ¥ä»¥ä¸‹å†…å®¹ï¼š

- [x] å±å¹•æ­£ç¡®æ˜¾ç¤º160x160åŠ¨ç”»
- [x] åŒå±åŒæ­¥æ˜¾ç¤º
- [x] æ—‹è½¬æ–¹å‘æ­£ç¡®ï¼ˆé¡ºæ—¶é’ˆ90åº¦ï¼‰
- [x] é¢œè‰²æ˜¾ç¤ºæ­£å¸¸ï¼ˆæ— Xå…‰æ•ˆæœï¼‰
- [x] å›¾åƒæ¸…æ™°ï¼Œæ— æ¨¡ç³Š
- [x] åŠ¨ç”»æµç•…åº¦æ­£å¸¸ï¼ˆ8 FPSï¼‰
- [x] æ— SPIä¼ è¾“é”™è¯¯æ—¥å¿—

---

## ğŸ› å¸¸è§é—®é¢˜

### é—®é¢˜1ï¼šå±å¹•æ— æ˜¾ç¤º

**å¯èƒ½åŸå› **ï¼š
- å¼•è„šé…ç½®é”™è¯¯
- CSæˆ–BLæ¥çº¿é”™è¯¯
- é©±åŠ¨èŠ¯ç‰‡å‹å·ä¸å¯¹

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ£€æŸ¥æ‰€æœ‰æ¥çº¿æ˜¯å¦æ­£ç¡®
2. ç¡®è®¤å±å¹•å‹å·æ˜¯GC9D01N
3. æ£€æŸ¥ä¸²å£æ—¥å¿—ä¸­çš„åˆå§‹åŒ–ä¿¡æ¯

### é—®é¢˜2ï¼šé¢œè‰²å¼‚å¸¸ï¼ˆXå…‰æ•ˆæœï¼‰

**å¯èƒ½åŸå› **ï¼š
- RGBé¡ºåºé…ç½®é”™è¯¯
- é¢œè‰²åè½¬è®¾ç½®é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. ç¡®è®¤ `DISPLAY_RGB_ORDER` æ˜¯ `LCD_RGB_ELEMENT_ORDER_RGB`
2. ç¡®è®¤ `invert_color` è®¾ç½®ä¸º `false`
3. é‡æ–°ç¼–è¯‘å¹¶çƒ§å½•

### é—®é¢˜3ï¼šæ—‹è½¬æ–¹å‘é”™è¯¯

**å¯èƒ½åŸå› **ï¼š
- FFmpegçš„transposeå‚æ•°é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**ï¼š
- `transpose=0`: 90Â°é¡ºæ—¶é’ˆ
- `transpose=1`: 90Â°é¡ºæ—¶é’ˆ
- `transpose=2`: 90Â°é€†æ—¶é’ˆ
- `transpose=3`: 90Â°é€†æ—¶é’ˆ

é‡æ–°ç”ŸæˆåŠ¨ç”»æ•°æ®å³å¯ã€‚

### é—®é¢˜4ï¼šå›¾åƒæ¨¡ç³Š

**å¯èƒ½åŸå› **ï¼š
- ä½¿ç”¨äº†ç¡¬ä»¶æ—‹è½¬ï¼ˆswap_xyï¼‰
- PNGåºåˆ—ç”Ÿæˆæ—¶å‚æ•°é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**ï¼š
- ç§»é™¤ `esp_lcd_panel_swap_xy` è°ƒç”¨
- ä½¿ç”¨FFmpegåœ¨ç”ŸæˆPNGæ—¶å°±æ—‹è½¬ï¼ˆæ–¹æ¡ˆAï¼‰

---

## ğŸ“Š æ€§èƒ½å¯¹æ¯”

| é¡¹ç›® | 1.28å¯¸å±å¹• | 0.71å¯¸å±å¹• | å˜åŒ– |
|------|-----------|-----------|------|
| åˆ†è¾¨ç‡ | 240x240 | 160x160 | -44% |
| åƒå¤§å°/å¸§ | 115.2 KB | 51.2 KB | -56% |
| æ€»å¤§å°ï¼ˆ16å¸§ï¼‰ | 1.84 MB | 800 KB | -57% |
| å¸§ç‡ | 8 FPS | 8 FPS | ä¸å˜ |
| åŠ¨ç”»æ—¶é•¿ | 2ç§’ | 2ç§’ | ä¸å˜ |

**ä¼˜åŠ¿**ï¼š
- æ˜¾è‘—å‡å°‘Flashå ç”¨ï¼ˆèŠ‚çœçº¦1MBï¼‰
- å‡å°‘å†…å­˜å ç”¨
- æ›´å¿«çš„SPIä¼ è¾“é€Ÿåº¦
- ä¿æŒç›¸åŒçš„å¸§ç‡å’Œæµç•…åº¦

---

## ğŸ“ ç›¸å…³æ–‡ä»¶æ¸…å•

### ä¿®æ”¹çš„æ–‡ä»¶

1. `main/display/eye_display.h` - åˆ†è¾¨ç‡å®šä¹‰
2. `main/boards/bcore-8311-eyecam/config.h` - æ‰€æœ‰åˆ†è¾¨ç‡å’Œæ˜¾ç¤ºé…ç½®
3. `main/boards/bcore-8311-eyecam/bcore-8311-eyecam.cc` - é©±åŠ¨åˆå§‹åŒ–
4. `main/boards/bcore-8311-eyecam/esp_lcd_gc9d01n.h` - GC9D01Né©±åŠ¨å¤´æ–‡ä»¶ï¼ˆæ–°å¢ï¼‰
5. `main/boards/bcore-8311-eyecam/esp_lcd_gc9d01n.c` - GC9D01Né©±åŠ¨å®ç°ï¼ˆæ–°å¢ï¼‰
6. `main/display/animations/anim_eye.h` - é‡æ–°ç”Ÿæˆçš„160x160åŠ¨ç”»æ•°æ®

### å‚è€ƒæ–‡æ¡£

- [çœ¼ç›åŠ¨ç”»ç³»ç»Ÿå®Œæ•´æŒ‡å—](./çœ¼ç›åŠ¨ç”»ç³»ç»Ÿå®Œæ•´æŒ‡å—.md)
- LilyGo T-Circle S3å¼€å‘æ¿é…ç½®ï¼š`main/boards/lilygo-t-circle-s3/`

---

## ğŸ‰ æ”¹é€ å®Œæˆ

æ­å–œï¼ä½ å·²æˆåŠŸå°†åŒç›®æœºå™¨äººä»1.28å¯¸å±å¹•æ”¹é€ ä¸º0.71å¯¸å±å¹•ã€‚

**æ”¹é€ æ•ˆæœ**ï¼š
- âœ… å±å¹•å°ºå¯¸å‡å°56%ï¼ˆä»1.28å¯¸åˆ°0.71å¯¸ï¼‰
- âœ… åˆ†è¾¨ç‡é™ä½44%ï¼ˆä»240x240åˆ°160x160ï¼‰
- âœ… Flashå ç”¨å‡å°‘çº¦1MB
- âœ… ä¿æŒç›¸åŒçš„åŠ¨ç”»æµç•…åº¦å’Œæ•ˆæœ
- âœ… æ”¯æŒå±å¹•æ—‹è½¬

**ä¸‹ä¸€æ­¥**ï¼š
- å¯ä»¥å°è¯•ä¸åŒçš„åŠ¨ç”»ä¸»é¢˜ï¼ˆé€šè¿‡ `SetEyeTheme()` å‡½æ•°ï¼‰
- è°ƒæ•´åŠ¨ç”»å¸§ç‡å’Œæ—¶é•¿ä»¥èŠ‚çœæ›´å¤šFlashç©ºé—´
- æ¢ç´¢æ›´å¤šçœ¼ç›è¡¨æƒ…å’ŒåŠ¨ç”»æ•ˆæœ

---

**æ–‡æ¡£ç‰ˆæœ¬**ï¼šv1.0
**æ›´æ–°æ—¥æœŸ**ï¼š2025-01-26
**ç»´æŠ¤è€…**ï¼šClaude Code
**é¡¹ç›®ç‰ˆæœ¬**ï¼šv1.8.9
